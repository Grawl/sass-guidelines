
# Архитектура

Разработка архитектуры CSS-проекта, вероятно, одна из самых сложных вещей, которые вы должны будете сделать в жизни проекта. Сохранять архитектуру последовательной и значимой – ещё сложнее.

К счастью, одно из главных преимуществ использования CSS-препроцессоров – в возможности разделить кодовую базу на несколько файлов без ущерба для производительности (в отличие от CSS-правила `@import`). Благодаря `@import` в Sass, совершенно безопасно (и на самом деле рекомендуется) использовать столько файлов, сколько необходимо в развитии, все они потом будут собраны в одной таблице стилей и так попадут на production.

Кроме того, я не могу не подчеркнуть потребность в папках, даже на небольших проектах. Дома вы не кладёте каждый лист бумаги в один и тот же ящик. Вы можете использовать папки; одну для дома, другую для банка, третью – для счетов, и так далее. Нет причин поступать иначе при определении структуры CSS-проекта. Разделяйте кодовую базу на папки, чтобы было легко найти материал позже.

Есть много популярных архитектур CSS-проектов: [OOCSS](http://oocss.org/), [Atomic Design](http://bradfrost.com/blog/post/atomic-web-design/), [Bootstrap](http://getbootstrap.com/), [Foundation](http://foundation.zurb.com/) и тому подобные… все они имеют свои достоинства, плюсы и минусы.

Я сам использую подход, который очень похож на [SMACSS](https://smacss.com/) от [Джонатана Снука](http://snook.ca/), который сосредотачивается на сохранении простоты и очевидности.

<div class="note">
  <p>Я понял, что в основном архитектура зависит от проекта. Используйте или адаптируйте предложенное решение так, чтобы вы имели дело с системой, которая соответствует вашим потребностям.</p>
</div>

###### Дальнейшее чтение

* [A Look at Different Sass Architectures](http://www.sitepoint.com/look-different-sass-architectures/)
* [An Introduction to OOCSS](http://www.smashingmagazine.com/2011/12/12/an-introduction-to-object-oriented-css-oocss/)

## Компоненты

Существует главное отличие между тем, чтобы сделать код *работающим*, или сделать его *хорошим*. Опять таки, CSS – вполне несносный язык <sup>[указать источник]</sup>. Чем меньше CSS мы имеем, тем лучше. Мы не хотим иметь дело с мегабайтами кода. Чтобы держать файлы стилей короткими и эффективными – и это не будет для вас сюрпризом – чаще всего будет хорошей идеей подумать об интерфейсе, как о наборе компонентов.

Компоненты могут быть чем угодно, до тех пор, пока они:

* делают одну и только одну вещь;
* могут быть повторно используемы;
* независимы.

Например, форма поиска должна рассматриваться в качестве компонента. Она должна иметь возможность быть используемой повторно на разных страницах, в различных ситуациях. Она не должна зависеть от положения в DOM (в подвале, в боковой панели, в основном содержимом…).

Большинство интерфейсов можно рассматривать как набор маленьких компонентов, и я настоятельно рекомендую вам придерживаться этой парадигмы. Это позволит не только сократить количество CSS, необходимого для всего проекта, но также упростить его поддержку, и прибрать хаотический беспорядок.

## Шаблон 7-1

Возвратимся к архитектуре? Я обычно использую так называемый *Шаблон 7-1*: 7 папок, 1 файл. Обычно у вас есть все ваши куски в 7 разных папках, и один файл в корневом каталоге (обычно с именем `main.scss`), который импортирует их все.

* `base/`
* `components/`
* `layout/`
* `pages/`
* `themes/`
* `utils/`
* `vendors/`

И, конечно же:

* `main.scss`

<div class="note">
  <p>Если вы хотите использовать шаблон 7-1, уже есть готовый <a href="https://github.com/HugoGiraudel/sass-boilerplate">шаблон</a> на GitHub. В нём должно быть всё, что вам нужно для начала работы с такой архитектурой.</p>
</div>

{% include images/wallpaper.html %}

В идеале, мы можем закончить с чем-то похожим:

{% include snippets/architecture/01/index.html %}

<div class="note">
  <p>Следующие файлы имеют то же соглашение по именованию, что и выше: они отделены нижним подчеркиванием.</p>
</div>

### Папка Base

Папка `base/` содержит то, что мы можем назвать общим шаблоном проекта. Там вы можете найти файл сброса, некоторые типографские правила, и, вероятно, стили, определяющие некоторые стандартные стили для часто используемых элементов HTML (я привык их называть `_base.scss`).

* `_base.scss`
* `_reset.scss`
* `_typography.scss`

<div class="note">
  <p>Если в вашем проекте<em>много</em> CSS-анимаций, вы можете решить добавить файл <code>_animations.scss</code> для хранения всех определений <code>@keyframes</code> всех ваших анимаций. Если вы используете их не регулярно, оставьте их рядом с селекторами, в которых вы их используете.</p>
</div>

### Папка Layout

Папка `layout/` содержит всё, что принимает участие в постройке раскладки сайта или приложения. Эта папка может содержать стили для основных частей сайта (шапка, подвал, навигация, боковая панель…), сетка или даже CSS-стили для всех форм.

* `_grid.scss`
* `_header.scss`
* `_footer.scss`
* `_sidebar.scss`
* `_forms.scss`
* `_navigation.scss`

<div class="note">
  <p>Папка <code>layout/</code> может быть названа <code>partials/</code>, на ваше усмотрение.</p>
</div>

### Папка Components

Для маленьких компонентов есть папка `components/`. В то время, как `layout/` –  *основные* (определяют общий каркас), код внутри `components/` больше сфокусирован на виджетах и содержит все модули, вроде слайдера, загрузчика и тому подобных виджетов. Обычно файлов в `components/` много, если приложение или сайт состоит из множества мелких модулей.

* `_media.scss`
* `_carousel.scss`
* `_thumbnails.scss`

<div class="note">
  <p>Папка <code>components/</code> может называться <code>modules/</code>, на ваше усмотрение.</p>
</div>

### Папка Pages

Если у вас есть стили, зависящие от страницы, лучше положить их в папку `pages/`, в файл, названный в честь страницы. Например, не редкость – иметь очень конкретные стили для главной страницы, следовательно, существует потребность в `_home.scss` в `pages/`.

* `_home.scss`
* `_contact.scss`

<div class="note">
  <p>В зависимости от способа доставки кода, эти файлы можно было бы назвать самостоятельно, чтобы избежать их объединения с другими стилями. На ваше усмотрение.</p>
</div>

### Папка Themes

В больших сайтах и проложениях не редко есть разные темы оформления. Есть разные способы работы с темами, я лично предпочитаю складывать их в папку `themes/`.

* `_theme.scss`
* `_admin.scss`

<div class="note">
  <p>Это очень зависит от проекта и не сильно распространено.</p>
</div>

### Папка Utils

Папка `utils/` собирает все инструменты и помощники Sass в проекте. Каждая глобальная переменная, функция и примесь должна быть помещена сюда.

Правило для этой папки в том, что она не должна создавать CSS при компиляции сама по себе. Это не что иное, как помощники Sass.

* `_variables.scss`
* `_mixins.scss`
* `_functions.scss`
* `_placeholders.scss`

При работе с очень крупным проектом с большим числом утилит, может быть интересным группировать их по тематикам вместо типов, например – типография (`_typography.scss`), темы (`_theming.scss`), и так далее. Каждый файл содержит все связанные помощники: переменные, функции, примеси и заполнители. Если делать так, код будет проще исследовать и поддерживать, особенно когда файлы становятся очень большими.

<div class="note">
  <p>Папка <code>utils/</code> может также быть названа <code>utilities/</code> или <code>helpers/</code>, на ваше усмотрение.</p>
</div>

### Папка Vendors

И последнее, но не менее важное, что большинство проектов будут иметь папку `vendors/`, содержащую все CSS-файлы из внешних библиотек и фреймворков – Normalize, Bootstrap, jQueryUI, FancyCarouselSliderjQueryPowered и так далее. Нахождение этих файлов в этой папке – хороший способ сказать: "Эй, это не я писал, не мой код, не моя ответственность".

* `_normalize.scss`
* `_bootstrap.scss`
* `_jquery-ui.scss`
* `_select2.scss`

Если вы хотите что-то переписать в этих файлах, то я рекомендую вам ввести восьмую папку `vendors-extensions/`, в которой вы будете хранить файлы перезаписи свойств с точно такими же именами.

Например, файл `vendors-extensions/_bootstrap.scss`, содержащий все CSS-правила на перезапись CSS-правил Bootstrap. Это для того, чтобы не править сами внешние модули, что на самом деле не очень хорошая идея.

### Файл Main

Главный файл (обычно названный `main.scss`) должен быть единственным файлом Sass, который не начинается с нижнего подчеркивания. Этот файл не должен содержать ничего, кроме `@import` и комментариев.

Файлы должны быть импортированы в соответствии с папкой размещения, один за другим, в соответствуещем порядке:

1. `utils/`
1. `vendors/`
1. `base/`
1. `layout/`
1. `components/`
1. `pages/`
1. `themes/`

Чтобы улучшить читаемость, главный файл должен следовать этим рекомендациям:

* один `@import` на строку;
* не вставлять новые строки между файлами из одной папки;
* новая строка после вставки последнего `@import` из одной и той же папки;
* не писать расширения файлов и нижние подчеркивания.

{% include snippets/architecture/02/index.html %}

Существует ещё один способ импорта, который действует так же. С одной стороны, это делает файл более читаемым. С другой стороны, это делает его обновление немного более болезненным. Во всяком случае, вам решать, что лучше, это не имеет большого значения. Основной файл следует следующим принципам:

* один `@import` на папку;
* снос строки после `@import`;
* каждый файл на своей строке;
* новая строка после последнего импорта файла из папки;
* не писать расширения файлов и нижние подчеркивания.

{% include snippets/architecture/03/index.html %}

<div class="note">
  <p>Для того, чтобы не импортировать каждый файл вручную, есть расширение Ruby Sass, которое называется <a href="https://github.com/chriseppstein/sass-globbing">sass-globbing</a>, оно позволяет использовать glob-шаблон в <code>@import</code> Sass, например – <code>@import "components/*"</code>.</p>
  <p>Как было сказано, я не рекомендую это, потому что используется упорядочение по алфавиту, что иногда может быть не тем, что вы хотите, особенно, когда вы имеете дело с языком, в котором важно упорядочивание.</p>
</div>

## Файл позора

Это интересная идея, которая стала популярна благодаря [Гарри Робертсу](http://csswizardry.com), [Дэйву Руперту](http://daverupert.com) и [Крису Койеру](http://css-tricks.com) и состоит в том, чтобы складывать все хаки и код, которым вы не гордитесь, в *файл позора*. Поэтому этот файл и имеет такое драматическое название – `_shame.scss`, импортируется в самом конце.

{% include snippets/architecture/04/index.html %}

###### Дальнейшее чтение

* [shame.css - full .net interview](http://csswizardry.com/2013/04/shame-css-full-net-interview/)
